package addition;

import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;
import acromate.common.util.Str;
import acromate.common.util.StringUtil;
import com.acromate.driver.db.DataStatement;

import dto.AlarmServiceDTO;

public class AlarmServiceList {
	
	public List getList(DataStatement stmt, String e164) {
		AlarmServiceDTO alarmServiceDTO;
        List<AlarmServiceDTO> alarmServiceList = new ArrayList<AlarmServiceDTO>();
        
        String sql = "\n SELECT e164, sequenceno, alarmtype, alarmtime, alarmdate ";
        sql = sql +  "\n   FROM table_alarmservice " ;
        sql = sql +  "\n  WHERE e164 = '" + e164 + "' ";
        sql = sql +  "\n  ORDER BY e164, sequenceno ";
        
        ResultSet rs = null;
        try {
            if (stmt != null) {
                rs = stmt.executeQuery(sql);
                while (rs.next()) {
                	alarmServiceDTO = new AlarmServiceDTO();
                	
                	alarmServiceDTO.setE164(Str.CheckNullString(rs.getString("e164")));
                	alarmServiceDTO.setSequenceNo(rs.getInt("sequenceno"));
                	alarmServiceDTO.setAlarmType(rs.getInt("alarmtype"));
                	alarmServiceDTO.setAlarmTime(Str.CheckNullString(rs.getString("alarmtime")));
                	alarmServiceDTO.setAlarmDate(Str.CheckNullString(rs.getString("alarmdate")));

                	alarmServiceList.add(alarmServiceDTO);
                }
                rs.close();
            } else           
                System.out.println("데이터베이스에 연결할 수 없습니다.");            
        } catch (Exception e) {
            System.out.println(e.getMessage());
            return alarmServiceList;
        } finally {
            try {
                if (rs != null)
                    rs.close();
            } catch (Exception e) {}
        }
        return alarmServiceList;
    }

}
