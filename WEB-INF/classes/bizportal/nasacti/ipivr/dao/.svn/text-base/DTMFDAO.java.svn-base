package bizportal.nasacti.ipivr.dao;

import java.sql.*;
import java.util.*;
import bizportal.nasacti.ipivr.DBPoolConnector;
import bizportal.nasacti.ipivr.dto.DTMFDTO;

public class DTMFDAO extends DBPoolConnector {
	private static DTMFDAO instance = new DTMFDAO();

	public static DTMFDAO getInstance() {
		return instance;
	}

	private DTMFDAO() {
	}

	public int updateDTMF(DTMFDTO dto) throws Exception {
		Connection cn = null;
		PreparedStatement pstmt1 = null;
        StringBuffer sb1 = new StringBuffer();

		int iRtn = -1;
		int iRtnCnt = 0;

		try {
			cn = this.getConnection();


			sb1.append("UPDATE nasa_system_info SET           \n");
			sb1.append("ns_dtmf_type = ? 			            ");

			pstmt1 = cn.prepareStatement(sb1.toString());

			pstmt1.setString(1, dto.getNsDtmfType());

			iRtnCnt = pstmt1.executeUpdate();

			if(iRtnCnt > 0) iRtn = 1;

		} catch(Exception e) {
			e.printStackTrace();
		} finally {
			if(pstmt1 != null) try{ pstmt1.close(); } catch(SQLException se) {se.printStackTrace();}
			if(cn != null) try{ cn.close(); } catch(SQLException se) {se.printStackTrace();}
		}
		return iRtn;

    }


	public DTMFDTO getDTMF() throws Exception {
		Connection cn = null;
		PreparedStatement pstmt = null;
		ResultSet rs = null;
		StringBuffer sb = new StringBuffer();

		DTMFDTO dto = new DTMFDTO();


		try {
			cn = this.getConnection();
			sb.append("SELECT  ns_dtmf_type         ");
			sb.append("FROM nasa_system_info        ");


			pstmt = cn.prepareStatement(sb.toString());
			rs = pstmt.executeQuery();

			if(rs.next()) {
			    dto.setNsDtmfType(rs.getString("ns_dtmf_type") == null ? "" : rs.getString("ns_dtmf_type"));
			}

		} catch(Exception e) {
			e.printStackTrace();
		} finally {
			if(rs != null) try{ rs.close(); } catch(SQLException se) {se.printStackTrace();}
			if(pstmt != null) try{ pstmt.close(); } catch(SQLException se) {se.printStackTrace();}
			if(cn != null) try{ cn.close(); } catch(SQLException se) {se.printStackTrace();}
		}

		return dto;

	}

}
