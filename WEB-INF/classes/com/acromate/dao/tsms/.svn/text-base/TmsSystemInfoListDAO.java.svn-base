package com.acromate.dao.tsms ;

import com.acromate.db.QueryStatement ;
import com.acromate.util.Str ;
import java.sql.ResultSet ;
import com.acromate.dataio.server.tms.system.TmsSystemInfoListDIO;
import com.acromate.dataio.server.tms.system.TmsSystemInfoDIO;

public class TmsSystemInfoListDAO {
    public TmsSystemInfoListDAO() {
        try {
            jbInit();
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
    public TmsSystemInfoListDIO getTmsSystemInfoList(QueryStatement statement) {
        String queryString = "" ;
        TmsSystemInfoListDIO tmsSystemInfoListDIO = new TmsSystemInfoListDIO() ;
        ResultSet rs = null ;
        TmsSystemInfoDIO tmsSystemInfoDIO ;

        try {
            queryString = "SELECT " ;
            queryString += "ID, " ;
            queryString += "Name, " ;
            queryString += "IPAddress, " ;
            queryString += "IPPort, " ;
            queryString += "LoginID, " ;
            queryString += "Password, " ;
            queryString += "X, " ;
            queryString += "Y, " ;
            queryString += "Status, " ;
            queryString += "SysInfo, " ;
            queryString += "Attempt, " ;
            queryString += "Answer" ;
            queryString += " From Table_TsmsSystemList order by x";
            rs = statement.executeQuery(queryString) ;

            while ( rs.next() )  {
                tmsSystemInfoDIO = new TmsSystemInfoDIO() ;
                tmsSystemInfoDIO.setId( rs.getInt(1) ) ;
                tmsSystemInfoDIO.setName( Str.CheckNullString(rs.getString(2)) ) ;
                tmsSystemInfoDIO.setIp( Str.CheckNullString(rs.getString(3)) ) ;
                tmsSystemInfoDIO.setPort( rs.getInt(4) ) ;
                tmsSystemInfoDIO.setUserID( Str.CheckNullString(rs.getString(5)) ) ;
                tmsSystemInfoDIO.setPassword( Str.CheckNullString(rs.getString(6)) ) ;
                tmsSystemInfoDIO.setX( rs.getInt(7) ) ;
                tmsSystemInfoDIO.setY( rs.getInt(8) ) ;
                tmsSystemInfoDIO.setStatus( rs.getInt(9) ) ;
                tmsSystemInfoDIO.setAttempt( Str.CheckNullString(rs.getString(11)) ) ;
                tmsSystemInfoDIO.setAnswer( Str.CheckNullString(rs.getString(12)) ) ;

                tmsSystemInfoListDIO.appendTail(tmsSystemInfoDIO) ;
            }
        } catch(Exception e) {
            e.printStackTrace() ;
            return null ;
        } finally {
            try {  if (rs != null) rs.close();  }
            catch(Exception e) { e.printStackTrace(); }
        }
        return tmsSystemInfoListDIO ;
    }

    public int getMaxID ( QueryStatement statement ) {
        int  nMax =  0 ;
        ResultSet rs = null ;

        try {
            String queryString = "SELECT  max(ID) From Table_TsmsSystemList " ;
            rs = statement.executeQuery(queryString) ;
            System.out.println(queryString) ;

            if ( rs.next() )  nMax = rs.getInt(1);
        } catch(Exception e) {
            e.printStackTrace();
        } finally {
            try {
                if (rs != null) rs.close();
            } catch(Exception e) { e.printStackTrace(); }
        }
        return nMax ;
    }

    public boolean insert (QueryStatement statement, TmsSystemInfoDIO tmsSystemInfoDIO ) {
        int max = getMaxID(statement);
        String queryString = "" ;
        int count = 0 ;
        int newID = max + 1 ;
        tmsSystemInfoDIO.setId(newID);

        try {
            queryString = " INSERT INTO Table_TsmsSystemList (" ;
            queryString += "ID, " ;
            queryString += "Name, " ;
            queryString += "IPAddress, " ;
            queryString += "IPPort, " ;
            queryString += "LoginID, " ;
            queryString += "Password, " ;
            queryString += "X, " ;
            queryString += "Y, " ;
            queryString += "Status, " ;
            queryString += "SysInfo, " ;
            queryString += "Attempt, " ;
            queryString += "Answer" ;
            queryString += ") VALUES (" ;
            queryString += "  " + tmsSystemInfoDIO.getId() + " , " ;
            queryString += " '" + tmsSystemInfoDIO.getName().replace("'","''") + "' ," ;
            queryString += " '" + tmsSystemInfoDIO.getIp() + "' ," ;
            queryString += " " + tmsSystemInfoDIO.getPort() + " ," ;
            queryString += " '" + tmsSystemInfoDIO.getUserID().replace("'","''") + "' ," ;
            queryString += " '" + tmsSystemInfoDIO.getPassword().replace("'","''") + "' ," ;
            queryString += " " + tmsSystemInfoDIO.getX() + " ," ;
            queryString += " " + tmsSystemInfoDIO.getY() + " ," ;
            queryString += " " + tmsSystemInfoDIO.getStatus() + " ," ;
            queryString += " '" + tmsSystemInfoDIO.getAttempt() + "' ," ;
            queryString += " '" + tmsSystemInfoDIO.getAnswer() + "' " ;
            queryString += ")" ;

            count = statement.executeUpdate(queryString) ;
            if (count <= 0) return false ;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }

    public boolean update (QueryStatement statement, TmsSystemInfoDIO tmsSystemInfoDIO ) {
        String queryString = "" ;
        String queryWhere = " where ID = " + tmsSystemInfoDIO.getId() + " " ;
        int count = 0 ;

        try {
            queryString = " UPDATE Table_TsmsSystemList SET " ;
            queryString += "Name = '" + tmsSystemInfoDIO.getName().replace("'","''") + "' ," ;
            queryString += "IPAddress = '" + tmsSystemInfoDIO.getIp() + "' ," ;
            queryString += "IPPort = " + tmsSystemInfoDIO.getPort() + " ," ;
            queryString += "LoginID = '" + tmsSystemInfoDIO.getUserID().replace("'","''") + "' ," ;
            queryString += "Password = '" + tmsSystemInfoDIO.getPassword().replace("'","''") + "' ," ;
            queryString += "X = " + tmsSystemInfoDIO.getX() + " ," ;
            queryString += "Y = " + tmsSystemInfoDIO.getY() + " ," ;
            queryString += "Status = " + tmsSystemInfoDIO.getStatus() + " ," ;
            queryString += "Attempt = '" + tmsSystemInfoDIO.getAttempt() + "' ," ;
            queryString += "Answer = '" + tmsSystemInfoDIO.getAnswer() + "' " ;
            queryString += queryWhere ;

            count = statement.executeUpdate(queryString) ;
            if ( count <= 0 ) return false;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }

    public boolean updateStatus (QueryStatement statement, TmsSystemInfoDIO tmsSystemInfoDIO ) {
        String queryString = "" ;
        String queryWhere = " where ID = " + tmsSystemInfoDIO.getId() + " " ;
        int count = 0 ;

        try {
            queryString = " UPDATE Table_TsmsSystemList SET " ;
            queryString += "Status = " + tmsSystemInfoDIO.getStatus() + " ," ;
            queryString += "Attempt = '" + tmsSystemInfoDIO.getAttempt() + "' ," ;
            queryString += "Answer = '" + tmsSystemInfoDIO.getAnswer() + "' " ;
            queryString += queryWhere ;

            count = statement.executeUpdate(queryString) ;
            if ( count <= 0 ) return false;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }


    public boolean updatePoint (QueryStatement statement, TmsSystemInfoDIO tmsSystemInfoDIO ) {
        String queryString = "" ;
        String queryWhere = " where ID = " + tmsSystemInfoDIO.getId() + " " ;
        int count = 0 ;

        try {
            queryString = " UPDATE Table_TsmsSystemList SET " ;
            queryString += "X = " + tmsSystemInfoDIO.getX() + " ," ;
            queryString += "Y = " + tmsSystemInfoDIO.getY() + " " ;
            queryString += queryWhere ;

            count = statement.executeUpdate(queryString) ;
            if ( count <= 0 ) return false;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }

    public boolean delete (QueryStatement statement, TmsSystemInfoDIO tmsSystemInfoDIO ) {
        String queryString = "" ;
        int count = 0 ;

        try {
            queryString = " DELETE FROM Table_TsmsSystemList WHERE " ;
            queryString += "ID = " + tmsSystemInfoDIO.getId() + " " ;

            count = statement.executeUpdate(queryString) ;
            if ( count < 1 ) return false ;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }

    private void jbInit() throws Exception {
    }
}


