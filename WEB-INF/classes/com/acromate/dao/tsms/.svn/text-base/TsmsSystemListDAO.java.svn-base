package com.acromate.dao.tsms ;

import com.acromate.db.QueryStatement ;
import java.util.ArrayList ;
import com.acromate.util.Str ;
import java.sql.ResultSet ;
import com.acromate.dto.tsms.TsmsSystemListDTO ;
import com.acromate.dataio.server.tms.system.TmsSystemInfoListDIO;
import com.acromate.dataio.server.tms.system.TmsSystemInfoDIO;

public class TsmsSystemListDAO {
    public TsmsSystemListDAO() {
        try {
            jbInit();
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
    public TmsSystemInfoListDIO getTmsSystemInfoList(QueryStatement statement) {
        String queryString = "" ;
        TmsSystemInfoListDIO tmsSystemInfoListDIO = new TmsSystemInfoListDIO() ;
        ResultSet rs = null ;
        TmsSystemInfoDIO tmsSystemInfoDIO ;

        try {
            queryString = "SELECT " ;
            queryString += "ID, " ;
            queryString += "Name, " ;
            queryString += "IPAddress, " ;
            queryString += "IPPort, " ;
            queryString += "LoginID, " ;
            queryString += "Password, " ;
            queryString += "X, " ;
            queryString += "Y, " ;
            queryString += "Status, " ;
            queryString += "SysInfo, " ;
            queryString += "Attempt, " ;
            queryString += "Answer" ;
            queryString += " From Table_TsmsSystemList order by x";
            rs = statement.executeQuery(queryString) ;

            while ( rs.next() )  {
                tmsSystemInfoDIO = new TmsSystemInfoDIO() ;
                tmsSystemInfoDIO.setId( rs.getInt(1) ) ;
                tmsSystemInfoDIO.setName( Str.CheckNullString(rs.getString(2)) ) ;
                tmsSystemInfoDIO.setIp( Str.CheckNullString(rs.getString(3)) ) ;
                tmsSystemInfoDIO.setPort( rs.getInt(4) ) ;
                tmsSystemInfoDIO.setUserID( Str.CheckNullString(rs.getString(5)) ) ;
                tmsSystemInfoDIO.setPassword( Str.CheckNullString(rs.getString(6)) ) ;
                tmsSystemInfoDIO.setX( rs.getInt(7) ) ;
                tmsSystemInfoDIO.setY( rs.getInt(8) ) ;
                tmsSystemInfoDIO.setStatus( rs.getInt(9) ) ;
                tmsSystemInfoDIO.setAttempt( Str.CheckNullString(rs.getString(11)) ) ;
                tmsSystemInfoDIO.setAnswer( Str.CheckNullString(rs.getString(12)) ) ;

                tmsSystemInfoListDIO.appendTail(tmsSystemInfoDIO) ;
            }
        } catch(Exception e) {
            e.printStackTrace() ;
            return null ;
        } finally {
            try {  if (rs != null) rs.close();  }
            catch(Exception e) { e.printStackTrace(); }
        }
        return tmsSystemInfoListDIO ;
    }

    public ArrayList getList(QueryStatement statement) {
        String queryString = "" ;
        ArrayList list = new ArrayList() ;
        ResultSet rs = null ;
        TsmsSystemListDTO tsmsSystemListDTO ;

        try {
            queryString = "SELECT " ;
            queryString += "ID, " ;
            queryString += "Name, " ;
            queryString += "IPAddress, " ;
            queryString += "IPPort, " ;
            queryString += "LoginID, " ;
            queryString += "Password, " ;
            queryString += "X, " ;
            queryString += "Y, " ;
            queryString += "Status, " ;
            queryString += "SysInfo, " ;
            queryString += "Attempt, " ;
            queryString += "Answer" ;
            queryString += " From Table_TsmsSystemList order by x";
            rs = statement.executeQuery(queryString) ;

            while ( rs.next() )  {
                tsmsSystemListDTO = new TsmsSystemListDTO() ;
                tsmsSystemListDTO.setID( rs.getInt(1) ) ;
                tsmsSystemListDTO.setName( Str.CheckNullString(rs.getString(2)) ) ;
                tsmsSystemListDTO.setIPAddress( Str.CheckNullString(rs.getString(3)) ) ;
                tsmsSystemListDTO.setIPPort( rs.getInt(4) ) ;
                tsmsSystemListDTO.setLoginID( Str.CheckNullString(rs.getString(5)) ) ;
                tsmsSystemListDTO.setPassword( Str.CheckNullString(rs.getString(6)) ) ;
                tsmsSystemListDTO.setX( rs.getInt(7) ) ;
                tsmsSystemListDTO.setY( rs.getInt(8) ) ;
                tsmsSystemListDTO.setStatus( rs.getInt(9) ) ;
                tsmsSystemListDTO.setSysInfo( Str.CheckNullString(rs.getString(10)) ) ;
                tsmsSystemListDTO.setAttempt( Str.CheckNullString(rs.getString(11)) ) ;
                tsmsSystemListDTO.setAnswer( Str.CheckNullString(rs.getString(12)) ) ;

                list.add(tsmsSystemListDTO) ;
            }
        } catch(Exception e) {
            e.printStackTrace() ;
            return null ;
        } finally {
            try {  if (rs != null) rs.close();  }
            catch(Exception e) { e.printStackTrace(); }
        }
        return list ;
    }

    public TsmsSystemListDTO getDTO(QueryStatement statement, TsmsSystemListDTO dto ) {
        String queryString = "" ;
        ResultSet rs = null ;
        TsmsSystemListDTO tsmsSystemListDTO = null ;

        try {
            queryString = "SELECT" ;
            queryString += "ID, " ;
            queryString += "Name, " ;
            queryString += "IPAddress, " ;
            queryString += "IPPort, " ;
            queryString += "LoginID, " ;
            queryString += "Password, " ;
            queryString += "X, " ;
            queryString += "Y, " ;
            queryString += "Status, " ;
            queryString += "SysInfo, " ;
            queryString += "Attempt, " ;
            queryString += "Answer" ;
            queryString += " From Table_TsmsSystemList";
            rs = statement.executeQuery(queryString) ;

            if ( rs.next() )  {
                tsmsSystemListDTO = new TsmsSystemListDTO() ;
                tsmsSystemListDTO.setID( rs.getInt(1) ) ;
                tsmsSystemListDTO.setName( Str.CheckNullString(rs.getString(2)) ) ;
                tsmsSystemListDTO.setIPAddress( Str.CheckNullString(rs.getString(3)) ) ;
                tsmsSystemListDTO.setIPPort( rs.getInt(4) ) ;
                tsmsSystemListDTO.setLoginID( Str.CheckNullString(rs.getString(5)) ) ;
                tsmsSystemListDTO.setPassword( Str.CheckNullString(rs.getString(6)) ) ;
                tsmsSystemListDTO.setX( rs.getInt(7) ) ;
                tsmsSystemListDTO.setY( rs.getInt(8) ) ;
                tsmsSystemListDTO.setStatus( rs.getInt(9) ) ;
                tsmsSystemListDTO.setSysInfo( Str.CheckNullString(rs.getString(10)) ) ;
                tsmsSystemListDTO.setAttempt( Str.CheckNullString(rs.getString(11)) ) ;
                tsmsSystemListDTO.setAnswer( Str.CheckNullString(rs.getString(12)) ) ;

            }
        } catch(Exception e) {
            e.printStackTrace() ;
        } finally {
            try {  if (rs != null) rs.close();  }
            catch(Exception e) { e.printStackTrace(); }
        }
        return tsmsSystemListDTO ;
    }


    public int getMaxID ( QueryStatement statement ) {
        int  nMax =  0 ;
        ResultSet rs = null ;

        try {
            String queryString = "SELECT  max(ID) From Table_TsmsSystemList " ;
            rs = statement.executeQuery(queryString) ;
            System.out.println(queryString) ;

            if ( rs.next() )  nMax = rs.getInt(1);
        } catch(Exception e) {
            e.printStackTrace();
        } finally {
            try {
                if (rs != null) rs.close();
            } catch(Exception e) { e.printStackTrace(); }
        }
        return nMax ;
    }

    public boolean insert (QueryStatement statement, TsmsSystemListDTO tsmsSystemListDTO ) {
        int max = getMaxID(statement);
        String queryString = "" ;
        int count = 0 ;
        int newID = max + 1 ;
        tsmsSystemListDTO.setID(newID);

        try {
            queryString = " INSERT INTO Table_TsmsSystemList (" ;
            queryString += "ID, " ;
            queryString += "Name, " ;
            queryString += "IPAddress, " ;
            queryString += "IPPort, " ;
            queryString += "LoginID, " ;
            queryString += "Password, " ;
            queryString += "X, " ;
            queryString += "Y, " ;
            queryString += "Status, " ;
            queryString += "SysInfo, " ;
            queryString += "Attempt, " ;
            queryString += "Answer" ;
            queryString += ") VALUES (" ;
            queryString += "  " + tsmsSystemListDTO.getID() + " , " ;
            queryString += " '" + tsmsSystemListDTO.getName().replace("'","''") + "' ," ;
            queryString += " '" + tsmsSystemListDTO.getIPAddress() + "' ," ;
            queryString += " " + tsmsSystemListDTO.getIPPort() + " ," ;
            queryString += " '" + tsmsSystemListDTO.getLoginID().replace("'","''") + "' ," ;
            queryString += " '" + tsmsSystemListDTO.getPassword().replace("'","''") + "' ," ;
            queryString += " " + tsmsSystemListDTO.getX() + " ," ;
            queryString += " " + tsmsSystemListDTO.getY() + " ," ;
            queryString += " " + tsmsSystemListDTO.getStatus() + " ," ;
            queryString += " '" + tsmsSystemListDTO.getAttempt() + "' ," ;
            queryString += " '" + tsmsSystemListDTO.getSysInfo() + "' ," ;
            queryString += " '" + tsmsSystemListDTO.getAnswer() + "' " ;
            queryString += ")" ;

            count = statement.executeUpdate(queryString) ;
            if (count <= 0) return false ;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }

    public boolean update (QueryStatement statement, TsmsSystemListDTO tsmsSystemListDTO ) {
        String queryString = "" ;
        String queryWhere = " where ID = " + tsmsSystemListDTO.getID() + " " ;
        int count = 0 ;

        try {
            queryString = " UPDATE Table_TsmsSystemList SET " ;
            queryString += "Name = '" + tsmsSystemListDTO.getName().replace("'","''") + "' ," ;
            queryString += "IPAddress = '" + tsmsSystemListDTO.getIPAddress() + "' ," ;
            queryString += "IPPort = " + tsmsSystemListDTO.getIPPort() + " ," ;
            queryString += "LoginID = '" + tsmsSystemListDTO.getLoginID().replace("'","''") + "' ," ;
            queryString += "Password = '" + tsmsSystemListDTO.getPassword().replace("'","''") + "' ," ;
            queryString += "X = " + tsmsSystemListDTO.getX() + " ," ;
            queryString += "Y = " + tsmsSystemListDTO.getY() + " ," ;
            queryString += "Status = " + tsmsSystemListDTO.getStatus() + " ," ;
            queryString += "SysInfo = '" + tsmsSystemListDTO.getSysInfo() + "' ," ;
            queryString += "Attempt = '" + tsmsSystemListDTO.getAttempt() + "' ," ;
            queryString += "Answer = '" + tsmsSystemListDTO.getAnswer() + "' " ;
            queryString += queryWhere ;

            count = statement.executeUpdate(queryString) ;
            if ( count <= 0 ) return false;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }

    public boolean updateStatus (QueryStatement statement, TsmsSystemListDTO tsmsSystemListDTO ) {
        String queryString = "" ;
        String queryWhere = " where ID = " + tsmsSystemListDTO.getID() + " " ;
        int count = 0 ;

        try {
            queryString = " UPDATE Table_TsmsSystemList SET " ;
            queryString += "Status = " + tsmsSystemListDTO.getStatus() + " ," ;
            queryString += "SysInfo = '" + tsmsSystemListDTO.getSysInfo() + "' ," ;
            queryString += "Attempt = '" + tsmsSystemListDTO.getAttempt() + "' ," ;
            queryString += "Answer = '" + tsmsSystemListDTO.getAnswer() + "' " ;
            queryString += queryWhere ;

            count = statement.executeUpdate(queryString) ;
            if ( count <= 0 ) return false;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }


    public boolean updatePoint (QueryStatement statement, TsmsSystemListDTO tsmsSystemListDTO ) {
        String queryString = "" ;
        String queryWhere = " where ID = " + tsmsSystemListDTO.getID() + " " ;
        int count = 0 ;

        try {
            queryString = " UPDATE Table_TsmsSystemList SET " ;
            queryString += "X = " + tsmsSystemListDTO.getX() + " ," ;
            queryString += "Y = " + tsmsSystemListDTO.getY() + " " ;
            queryString += queryWhere ;

            count = statement.executeUpdate(queryString) ;
            if ( count <= 0 ) return false;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }

    public boolean delete (QueryStatement statement, TsmsSystemListDTO tsmsSystemListDTO ) {
        String queryString = "" ;
        int count = 0 ;

        try {
            queryString = " DELETE FROM Table_TsmsSystemList WHERE " ;
            queryString += "ID = " + tsmsSystemListDTO.getID() + " " ;

            count = statement.executeUpdate(queryString) ;
            if ( count < 1 ) return false ;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }

    private void jbInit() throws Exception {
    }
}


