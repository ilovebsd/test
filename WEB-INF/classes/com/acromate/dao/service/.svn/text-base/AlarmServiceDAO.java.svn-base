package com.acromate.dao.service;

/**
 * <p>Title: </p>
 *
 * <p>Description: </p>
 *
 * <p>Copyright: Copyright (c) 2007</p>
 *
 * <p>Company: </p>
 *
 * @author not attributable
 * @version 1.0
 */
import com.acromate.db.QueryStatement ;
import java.util.ArrayList;
import com.acromate.util.Str;
import java.sql.ResultSet;
import com.acromate.dto.service.AlarmServiceDTO;

public class AlarmServiceDAO {

    private AlarmServiceDTO alarmServiceDTO ;
    QueryStatement statement ;

    public AlarmServiceDAO() {}

    public AlarmServiceDAO( QueryStatement statement, AlarmServiceDTO alarmServiceDTO ) {
        this.statement = statement ;
        this.alarmServiceDTO = alarmServiceDTO ;
    }


    public boolean isSelected(QueryStatement statement, String strE164 ) {
        AlarmServiceDTO alarmServiceDTO = null;
        ResultSet rs = null;
        int count = 0 ;
        try {
            String queryString = "SELECT count(*) From Table_AlarmService  Where  E164 = '" + strE164 + "' ";
            rs = statement.executeQuery(queryString) ;
            if ( rs.next() )  {
                count = rs.getInt(1);
            }
        } catch(Exception e) {
            e.printStackTrace();
        } finally {
            try {
                if (rs != null) rs.close();
            } catch(Exception e) { e.printStackTrace(); }
        }
        if (count > 0) return true ;
        else return false ;
    }

    public AlarmServiceDTO getDTO(QueryStatement statement, String strE164, int nSequenceNo ) {
        AlarmServiceDTO alarmServiceDTO = null;
        ResultSet rs = null;

        String strWhere = " Where 1 = 1 ";

        if(!strE164.equals("")) strWhere += " AND E164 = '" + strE164 + "' ";
        if(nSequenceNo > 0) strWhere += " AND SequenceNo = " + nSequenceNo + " " ;

        try {
            String queryString = "SELECT E164, SequenceNo, AlarmType, AlarmTime, AlarmDate ";
            queryString += " From Table_AlarmService ";
            queryString += strWhere;

            System.out.println(queryString) ;
            rs = statement.executeQuery(queryString) ;

            while ( rs.next() )  {
                alarmServiceDTO = new AlarmServiceDTO() ;
                alarmServiceDTO.setE164(Str.CheckNullString(rs.getString(1)));
                alarmServiceDTO.setSequenceNo(rs.getInt(2));
                alarmServiceDTO.setAlarmType(rs.getInt(3));
                alarmServiceDTO.setAlarmTime(Str.CheckNullString(rs.getString(4)));
                alarmServiceDTO.setAlarmDate(Str.CheckNullString(rs.getString(5)));
            }
        } catch(Exception e) {
            e.printStackTrace();
        } finally {
            try {
                if (rs != null) rs.close();
            } catch(Exception e) { e.printStackTrace(); }
        }
        return alarmServiceDTO;
    }

    public boolean insert ( QueryStatement statement, AlarmServiceDTO alarmServiceDTO  ) {
        String queryString = "";
        int count = 0;
        try {
            if (statement == null) {
                return false;
            }

            queryString =   " INSERT INTO Table_AlarmService ";
            queryString += " ( E164, SequenceNo, AlarmType, AlarmTime, AlarmDate) ";
            queryString += " VALUES (" ;

            queryString += " '"+alarmServiceDTO.getE164()+"', ";
            queryString += " "+alarmServiceDTO.getSequenceNo()+", ";
            queryString += " "+alarmServiceDTO.getAlarmType()+", ";
            queryString += " '"+alarmServiceDTO.getAlarmTime()+"', ";
            queryString += " '"+alarmServiceDTO.getAlarmDate()+"') ";

            System.out.println(queryString) ;
            count = statement.executeUpdate(queryString);
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
        return true ;
    }


    public boolean deleteE164( QueryStatement statement, String strE164) {
        String queryString = "";
        int count = 0;
        try {
            if (statement == null) {
                return false;
            }
            queryString = " DELETE FROM Table_AlarmService WHERE E164 = '" + strE164+ "' " ;

            count = statement.executeUpdate(queryString);
            System.out.println(queryString) ;
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
        return true ;
    }

    public boolean delete( QueryStatement statement,  AlarmServiceDTO alarmServiceDTO) {
        String queryString = "";
        int count = 0;
        try {
            if (statement == null) {
                return false;
            }
            queryString = " DELETE FROM Table_AlarmService WHERE E164 = '" + alarmServiceDTO.getE164()+ "' " ;
            queryString += " AND SequenceNo = " + alarmServiceDTO.getSequenceNo() + " " ;

            count = statement.executeUpdate(queryString);
            System.out.println(queryString) ;
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
        return true ;
    }


}
