package com.acromate.dao.service ;

import com.acromate.db.QueryStatement ;
import java.util.ArrayList ;
import com.acromate.util.Str ;
import java.sql.ResultSet ;
import com.acromate.dto.service.AddMRBTDTO ;

public class AddMRBTDAO {
    public AddMRBTDAO() {}
    public ArrayList getList(QueryStatement statement, String E164) {
        String queryString = "" ;
        ArrayList list = new ArrayList() ;
        ResultSet rs = null ;
        AddMRBTDTO addMRBTDTO ;

        try {
            queryString = "SELECT " ;
            queryString += "E164, " ;
            queryString += "DAYValue, " ;
            queryString += "StartTime, " ;
            queryString += "EndTime, " ;
            queryString += "Sound" ;
            queryString += " From TABLE_AddMRBT ";
            queryString += " Where e164 = '" + E164 + "' ";
            System.out.println(queryString);
            rs = statement.executeQuery(queryString) ;

            while ( rs.next() )  {
                addMRBTDTO = new AddMRBTDTO() ;
                addMRBTDTO.setE164( Str.CheckNullString(rs.getString("E164")) ) ;
                addMRBTDTO.setDAYValue( Str.CheckNullString(rs.getString("DAYValue")) ) ;
                addMRBTDTO.setStartTime( Str.CheckNullString(rs.getString("StartTime")) ) ;
                addMRBTDTO.setEndTime( Str.CheckNullString(rs.getString("EndTime")) ) ;
                addMRBTDTO.setSound( Str.CheckNullString(rs.getString("Sound")) ) ;

                list.add(addMRBTDTO) ;
            }
        } catch(Exception e) {
            e.printStackTrace() ;
        } finally {
            try {  if (rs != null) rs.close();  }
            catch(Exception e) { e.printStackTrace(); }
        }
        return list ;
    }

    public AddMRBTDTO getDTO(QueryStatement statement, AddMRBTDTO dto ) {
        String queryString = "" ;
        ResultSet rs = null ;
        AddMRBTDTO addMRBTDTO = null ;

        try {
            queryString = "SELECT " ;
            queryString += "E164, " ;
            queryString += "DAYValue, " ;
            queryString += "StartTime, " ;
            queryString += "EndTime, " ;
            queryString += "Sound" ;
            queryString += " From TABLE_AddMRBT";
            rs = statement.executeQuery(queryString) ;

            if ( rs.next() )  {
                addMRBTDTO = new AddMRBTDTO() ;
                addMRBTDTO.setE164( Str.CheckNullString(rs.getString(0)) ) ;
                addMRBTDTO.setDAYValue( Str.CheckNullString(rs.getString(1)) ) ;
                addMRBTDTO.setStartTime( Str.CheckNullString(rs.getString(2)) ) ;
                addMRBTDTO.setEndTime( Str.CheckNullString(rs.getString(3)) ) ;
                addMRBTDTO.setSound( Str.CheckNullString(rs.getString(4)) ) ;

            }
        } catch(Exception e) {
            e.printStackTrace() ;
        } finally {
            try {  if (rs != null) rs.close();  }
            catch(Exception e) { e.printStackTrace(); }
        }
        return addMRBTDTO ;
    }

    public boolean insert (QueryStatement statement, AddMRBTDTO addMRBTDTO ) {
        String queryString = "" ;
        int count = 0 ;

        try {
            queryString = " INSERT INTO TABLE_AddMRBT (" ;
            queryString += "E164, " ;
            queryString += "DAYValue, " ;
            queryString += "StartTime, " ;
            queryString += "EndTime, " ;
            queryString += "Sound" ;
            queryString += ") VALUES (" ;
            queryString += " '" + addMRBTDTO.getE164() + "' ," ;
            queryString += " '" + addMRBTDTO.getDAYValue() + "' ," ;
            queryString += " '" + addMRBTDTO.getStartTime() + "' ," ;
            queryString += " '" + addMRBTDTO.getEndTime() + "' ," ;
            queryString += " '" + addMRBTDTO.getSound() + "' " ;
            queryString += ")" ;
            System.out.println(queryString);
            count = statement.executeUpdate(queryString) ;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }

    public boolean update (QueryStatement statement, AddMRBTDTO addMRBTDTO ) {
        String queryString = "" ;
        int count = 0 ;

        try {
            queryString = " UPDATE TABLE_AddMRBT SET " ;
            queryString += "DAYValue = '" + addMRBTDTO.getDAYValue() + "' ," ;
            queryString += "StartTime = '" + addMRBTDTO.getStartTime() + "' ," ;
            queryString += "EndTime = '" + addMRBTDTO.getEndTime() + "' ," ;
            queryString += "Sound = '" + addMRBTDTO.getSound() + "' " ;
            queryString += " WHERE E164='" + addMRBTDTO.getE164() + "'";
            System.out.println(queryString);
            count = statement.executeUpdate(queryString) ;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }

    public boolean delete (QueryStatement statement, AddMRBTDTO addMRBTDTO ) {
        String queryString = "" ;
        int count = 0 ;

        try {
            queryString = " DELETE FROM TABLE_AddMRBT WHERE " ;
            queryString += "E164 = '" + addMRBTDTO.getE164() + "' ," ;
            queryString += "DAYValue = '" + addMRBTDTO.getDAYValue() + "' ," ;
            queryString += "StartTime = '" + addMRBTDTO.getStartTime() + "' ," ;
            queryString += "EndTime = '" + addMRBTDTO.getEndTime() + "' ," ;
            queryString += "Sound = '" + addMRBTDTO.getSound() + "' " ;

            count = statement.executeUpdate(queryString) ;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }

    public boolean deleteE164All( QueryStatement statement,  String strE164 ) {
        String queryString = "";
        int count = 0;
        try {
            if (statement == null) {
                return false;
            }
            queryString = " DELETE FROM TABLE_AddMRBT Where e164 = '" + strE164+ "' " ;
            System.out.println(queryString);
            count = statement.executeUpdate(queryString);
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
        return true ;
    }

}

