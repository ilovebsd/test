package com.acromate.dao.element;

/**
 * <p>Title: </p>
 *
 * <p>Description: </p>
 *
 * <p>Copyright: Copyright (c) 2007</p>
 *
 * <p>Company: </p>
 *
 * @author not attributable
 * @version 1.0
 */
import com.acromate.db.QueryStatement ;
import java.util.ArrayList;
import com.acromate.util.Str;
import java.sql.ResultSet;
import com.acromate.dto.element.RouteStateDTO;
import com.acromate.util.Logger;

public class RouteStateDAO {
    private Logger log = Logger.getLogger(this.getClass());

    private RouteStateDTO routeStateDTO ;
    QueryStatement statement ;

    public RouteStateDAO() {}

    public RouteStateDAO( QueryStatement statement, RouteStateDTO routeStateDTO ) {
        this.statement = statement ;
        this.routeStateDTO = routeStateDTO ;
    }
    public int getProtocol(QueryStatement statement, String EndpointID) {
        ResultSet rs = null ;
        int protocol = 0;

        String strWhere = " Where ENDPOINTCLASS = 35 ";
        if(!EndpointID.equals("")) strWhere += " AND EndpointID = '" + EndpointID+ "' ";
        try {
            String queryString = "SELECT Protocol From Table_RouteState " + strWhere ;
            rs = statement.executeQuery(queryString) ;
            log.info(queryString) ;
            if ( rs.next() )  {
            	protocol = rs.getInt("Protocol");
            }
        } catch(Exception e) {
            log.error("exception occurred > ", e);
        } finally {
            try {
                if (rs != null) rs.close();
            } catch(Exception e) { log.error("exception occurred > ", e); }
        }

        return protocol;
    }
    public boolean isVip(QueryStatement statement, String EndpointID, int Protocol) {
        RouteStateDTO routeStateDTO = null ;
        ResultSet rs = null ;
        boolean vip = false;

        String strWhere = " Where ENDPOINTCLASS = 35 ";
        if(!EndpointID.equals(""))
            strWhere += " AND EndpointID = '" + EndpointID+ "' ";
        if(Protocol > 0)
            strWhere += " AND Protocol = " + Protocol+ " ";
        try {
            String queryString = "SELECT ISLOCAL From Table_RouteState " + strWhere ;
            rs = statement.executeQuery(queryString) ;
            log.info(queryString) ;
            if ( rs.next() )  {
                if (rs.getInt("ISLOCAL") == 1) vip = true;
            }
        } catch(Exception e) {
            log.error("exception occurred > ", e);
        } finally {
            try {
                if (rs != null) rs.close();
            } catch(Exception e) { log.error("exception occurred > ", e); }
        }

        return vip;
    }
    public ArrayList getList(QueryStatement statement, String EndpointID, int Protocol) {
        ArrayList list = new ArrayList() ;
        RouteStateDTO routeStateDTO = null ;
        ResultSet rs = null ;

        String strWhere = " Where ENDPOINTCLASS != 35 ";

        if(!EndpointID.equals("")){
            strWhere += " AND EndpointID = '" + EndpointID+ "' ";
        }
        if(Protocol > 0){
            strWhere += " AND Protocol = " + Protocol+ " ";
        }

        try {
            String queryString = "SELECT ENDPOINTID, PROTOCOL, ENDPOINTCLASS,  ROUTECODE, ROUTENAME, ROUTETYPE, ISLOCAL, GROUPID, GROUPATTACH, ";
            queryString += " INCALLEEBLOCK, INCALLERBLOCK, OUTCALLERBLOCK, ServiceFlag, StateFlag, CHANNELLIMITMODE, ";
            queryString += " INMAXCALL, OUTMAXCALL, TOTALMAXCALL, INCURRENTCALL, OUTCURRENTCALL, INALARMCALL, OUTALARMCALL, TOTALALARMCALL, ";
            queryString += " BLOCKCOUNT, INSTARTPOSITION, INCUTPREFIX, INADDPREFIX, OUTSTARTPOSITION, OUTCUTPREFIX, OUTADDPREFIX, ";
            queryString += " INCUTCID, INADDCID, OUTCUTCID, OUTADDCID, INREPLACE, OUTREPLACE, MAXDETOURCOUNT, TIMEOUTFAULT, INADDIBLEFLAG, ";
            queryString += " OUTADDIBLEFLAG, OPTIONS, CHARGETYPE, CHARGENUMBER, ZONECODE ";
            queryString += " From Table_RouteState " + strWhere ;
            rs = statement.executeQuery(queryString) ;
            log.info(queryString) ;

            while ( rs.next() )  {
                routeStateDTO = new RouteStateDTO() ;
                routeStateDTO.setEndpointid(Str.CheckNullString(rs.getString(1)));
                routeStateDTO.setProtocol(rs.getInt(2));
                routeStateDTO.setEndpointclass(rs.getInt(3));
                routeStateDTO.setRouteCode(Str.CheckNullString(rs.getString(4)));
                routeStateDTO.setRouteName(Str.CheckNullString(rs.getString(5)));
                routeStateDTO.setRoutetype(Str.CheckNullString(rs.getString(6)));
                routeStateDTO.setIsLocal(rs.getInt(7));
                routeStateDTO.setGroupId(Str.CheckNullString(rs.getString(8)));
                routeStateDTO.setGroupAttach(rs.getInt(9));
                routeStateDTO.setInCalleeBlock(rs.getInt(10));
                routeStateDTO.setInCallerBlock(rs.getInt(11));
                routeStateDTO.setOutCallerBlock(rs.getInt(12));
                routeStateDTO.setServiceFlag(rs.getInt(13));
                routeStateDTO.setStateFlag(rs.getInt(14));
                routeStateDTO.setChannellimitmode(rs.getInt(15));
                routeStateDTO.setInMaxcall(rs.getInt(16));
                routeStateDTO.setOutMaxcall(rs.getInt(17));
                routeStateDTO.setTotalmaxcall(rs.getInt(18));
                routeStateDTO.setInCurrentcall(rs.getInt(19));
                routeStateDTO.setOutCurrentcall(rs.getInt(20));
                routeStateDTO.setInAlarmcall(rs.getInt(21));
                routeStateDTO.setOutAlarmcall(rs.getInt(22));
                routeStateDTO.setTotalalarmcall(rs.getInt(23));
                routeStateDTO.setBlockcount(rs.getInt(24));
                routeStateDTO.setInstartposition(rs.getInt(25));
                routeStateDTO.setIncutprefix(rs.getInt(26));
                routeStateDTO.setInaddprefix(Str.CheckNullString(rs.getString(27)));
                routeStateDTO.setOutstartposition(rs.getInt(28));
                routeStateDTO.setOutcutprefix(rs.getInt(29));
                routeStateDTO.setOutaddprefix(Str.CheckNullString(rs.getString(30)));
                routeStateDTO.setInCutcid(rs.getInt(31));
                routeStateDTO.setInAddcid(Str.CheckNullString(rs.getString(32)));
                routeStateDTO.setOutCutcid(rs.getInt(33));
                routeStateDTO.setOutAddcid(Str.CheckNullString(rs.getString(34)));
                routeStateDTO.setInReplace(rs.getInt(35));
                routeStateDTO.setOutReplace(rs.getInt(36));
                routeStateDTO.setMaxdetourcount(rs.getInt(37));
                routeStateDTO.setTimeOutFault(rs.getInt(38));
                routeStateDTO.setInAddibleFlag(rs.getInt(39));
                routeStateDTO.setOutAddibleFlag(rs.getInt(40));
                routeStateDTO.setOptions(rs.getInt(41));
                routeStateDTO.setChargeType(rs.getInt(42));
                routeStateDTO.setChargeNumber(Str.CheckNullString(rs.getString(43)));
                routeStateDTO.setZonecode(Str.CheckNullString(rs.getString(44)));

                list.add(routeStateDTO) ;
            }
        } catch(Exception e) {
            log.error("exception occurred > ", e);
        } finally {
            try {
                if (rs != null) rs.close();
            } catch(Exception e) { log.error("exception occurred > ", e); }
        }

        return list;
    }


    public RouteStateDTO getDTO(QueryStatement statement, String EndpointID, int Protocol) {
        RouteStateDTO routeStateDTO = null ;
        ResultSet rs = null ;
        String strWhere = " Where EndpointID = '" + EndpointID+ "'  AND Protocol = " + Protocol+ " ";

        try {
            String queryString = "SELECT ENDPOINTID, PROTOCOL, ENDPOINTCLASS,  ROUTECODE, ROUTENAME, ROUTETYPE, ISLOCAL, GROUPID, GROUPATTACH, ";
            queryString += " INCALLEEBLOCK, INCALLERBLOCK, OUTCALLERBLOCK, ServiceFlag, StateFlag, CHANNELLIMITMODE, ";
            queryString += " INMAXCALL, OUTMAXCALL, TOTALMAXCALL, INCURRENTCALL, OUTCURRENTCALL, INALARMCALL, OUTALARMCALL, TOTALALARMCALL, ";
            queryString += " BLOCKCOUNT, INSTARTPOSITION, INCUTPREFIX, INADDPREFIX, OUTSTARTPOSITION, OUTCUTPREFIX, OUTADDPREFIX, ";
            queryString += " INCUTCID, INADDCID, OUTCUTCID, OUTADDCID, INREPLACE, OUTREPLACE, MAXDETOURCOUNT, TIMEOUTFAULT, INADDIBLEFLAG, ";
            queryString += " OUTADDIBLEFLAG, OPTIONS, CHARGETYPE, CHARGENUMBER, ZONECODE ";
            queryString += " From Table_RouteState " + strWhere ;
            rs = statement.executeQuery(queryString) ;

            if ( rs.next() )  {
                routeStateDTO = new RouteStateDTO() ;
                routeStateDTO.setEndpointid(Str.CheckNullString(rs.getString(1)));
                routeStateDTO.setProtocol(rs.getInt(2));
                routeStateDTO.setEndpointclass(rs.getInt(3));
                routeStateDTO.setRouteCode(Str.CheckNullString(rs.getString(4)));
                routeStateDTO.setRouteName(Str.CheckNullString(rs.getString(5)));
                routeStateDTO.setRoutetype(Str.CheckNullString(rs.getString(6)));
                routeStateDTO.setIsLocal(rs.getInt(7));
                routeStateDTO.setGroupId(Str.CheckNullString(rs.getString(8)));
                routeStateDTO.setGroupAttach(rs.getInt(9));
                routeStateDTO.setInCalleeBlock(rs.getInt(10));
                routeStateDTO.setInCallerBlock(rs.getInt(11));
                routeStateDTO.setOutCallerBlock(rs.getInt(12));
                routeStateDTO.setServiceFlag(rs.getInt(13));
                routeStateDTO.setStateFlag(rs.getInt(14));
                routeStateDTO.setChannellimitmode(rs.getInt(15));
                routeStateDTO.setInMaxcall(rs.getInt(16));
                routeStateDTO.setOutMaxcall(rs.getInt(17));
                routeStateDTO.setTotalmaxcall(rs.getInt(18));
                routeStateDTO.setInCurrentcall(rs.getInt(19));
                routeStateDTO.setOutCurrentcall(rs.getInt(20));
                routeStateDTO.setInAlarmcall(rs.getInt(21));
                routeStateDTO.setOutAlarmcall(rs.getInt(22));
                routeStateDTO.setTotalalarmcall(rs.getInt(23));
                routeStateDTO.setBlockcount(rs.getInt(24));
                routeStateDTO.setInstartposition(rs.getInt(25));
                routeStateDTO.setIncutprefix(rs.getInt(26));
                routeStateDTO.setInaddprefix(Str.CheckNullString(rs.getString(27)));
                routeStateDTO.setOutstartposition(rs.getInt(28));
                routeStateDTO.setOutcutprefix(rs.getInt(29));
                routeStateDTO.setOutaddprefix(Str.CheckNullString(rs.getString(30)));
                routeStateDTO.setInCutcid(rs.getInt(31));
                routeStateDTO.setInAddcid(Str.CheckNullString(rs.getString(32)));
                routeStateDTO.setOutCutcid(rs.getInt(33));
                routeStateDTO.setOutAddcid(Str.CheckNullString(rs.getString(34)));
                routeStateDTO.setInReplace(rs.getInt(35));
                routeStateDTO.setOutReplace(rs.getInt(36));
                routeStateDTO.setMaxdetourcount(rs.getInt(37));
                routeStateDTO.setTimeOutFault(rs.getInt(38));
                routeStateDTO.setInAddibleFlag(rs.getInt(39));
                routeStateDTO.setOutAddibleFlag(rs.getInt(40));
                routeStateDTO.setOptions(rs.getInt(41));
                routeStateDTO.setChargeType(rs.getInt(42));
                routeStateDTO.setChargeNumber(Str.CheckNullString(rs.getString(43)));
                routeStateDTO.setZonecode(Str.CheckNullString(rs.getString(44)));
            }
        } catch(Exception e) {
            e.printStackTrace();
        } finally {
            try {
                if (rs != null) rs.close();
            } catch(Exception e) { e.printStackTrace(); }
        }

        return routeStateDTO;
    }

    public boolean insert ( QueryStatement statement, RouteStateDTO routeStateDTO  ) {
        String queryString = "";
        int count = 0;
        try {
            if (statement == null) {
                return false;
            }

            queryString =   " INSERT INTO Table_RouteState ";
            queryString += " (ENDPOINTID, PROTOCOL, ENDPOINTCLASS,  ROUTECODE, ROUTENAME, ROUTETYPE, ISLOCAL, GROUPID, GROUPATTACH, ";
            queryString += " INCALLEEBLOCK, INCALLERBLOCK, OUTCALLERBLOCK, ServiceFlag, StateFlag, CHANNELLIMITMODE, ";
            queryString += " INMAXCALL, OUTMAXCALL, TOTALMAXCALL, INCURRENTCALL, OUTCURRENTCALL, INALARMCALL, OUTALARMCALL, TOTALALARMCALL, ";
            queryString += " BLOCKCOUNT, INSTARTPOSITION, INCUTPREFIX, INADDPREFIX, OUTSTARTPOSITION, OUTCUTPREFIX, OUTADDPREFIX, ";
            queryString += " INCUTCID, INADDCID, OUTCUTCID, OUTADDCID, INREPLACE, OUTREPLACE, MAXDETOURCOUNT, TIMEOUTFAULT, INADDIBLEFLAG, ";
            queryString += " OUTADDIBLEFLAG, OPTIONS, CHARGETYPE, CHARGENUMBER, ZONECODE)";
            queryString += " VALUES (" ;
            queryString += " '"+routeStateDTO.getEndpointid()+"', ";
            queryString += "  "+routeStateDTO.getProtocol()+", ";
            queryString += "  "+routeStateDTO.getEndpointclass()+", ";
            queryString += " '"+routeStateDTO.getRouteCode()+"', ";
            queryString += " '"+routeStateDTO.getRouteName()+"', ";
            queryString += " '"+routeStateDTO.getRoutetype()+"', ";
            queryString += "  "+routeStateDTO.getIsLocal()+", ";
            queryString += " '"+routeStateDTO.getGroupId()+"', ";
            queryString += "  "+routeStateDTO.getGroupAttach()+", ";
            queryString += "  "+routeStateDTO.getInCalleeBlock()+", ";
            queryString += "  "+routeStateDTO.getInCallerBlock()+", ";
            queryString += "  "+routeStateDTO.getOutCallerBlock()+", ";
            queryString += "  "+routeStateDTO.getServiceFlag()+", ";
            queryString += "  "+routeStateDTO.getStateFlag()+", ";
            queryString += "  "+routeStateDTO.getChannellimitmode()+", ";
            queryString += "  "+routeStateDTO.getInMaxcall()+", ";
            queryString += "  "+routeStateDTO.getOutMaxcall()+", ";
            queryString += "  "+routeStateDTO.getTotalmaxcall()+", ";
            queryString += "  "+routeStateDTO.getInCurrentcall()+", ";
            queryString += "  "+routeStateDTO.getOutCurrentcall()+", ";
            queryString += "  "+routeStateDTO.getInAlarmcall()+", ";
            queryString += "  "+routeStateDTO.getOutAlarmcall()+", ";
            queryString += "  "+routeStateDTO.getTotalalarmcall()+", ";
            queryString += "  "+routeStateDTO.getBlockcount()+", ";
            queryString += "  "+routeStateDTO.getInstartposition()+", ";
            queryString += "  "+routeStateDTO.getIncutprefix()+", ";
            queryString += " '"+routeStateDTO.getInaddprefix()+"', ";
            queryString += "  "+routeStateDTO.getOutstartposition()+", ";
            queryString += "  "+routeStateDTO.getOutcutprefix()+", ";
            queryString += " '"+routeStateDTO.getOutaddprefix()+"', ";
            queryString += "  "+routeStateDTO.getInCutcid()+", ";
            queryString += " '"+routeStateDTO.getInAddcid()+"', ";
            queryString += "  "+routeStateDTO.getOutCutcid()+", ";
            queryString += " '"+routeStateDTO.getOutAddcid()+"', ";
            queryString += "  "+routeStateDTO.getInReplace()+", ";
            queryString += "  "+routeStateDTO.getOutReplace()+", ";
            queryString += "  "+routeStateDTO.getMaxdetourcount()+", ";
            queryString += "  "+routeStateDTO.getTimeOutFault()+", ";
            queryString += "  "+routeStateDTO.getInAddibleFlag()+", ";
            queryString += "  "+routeStateDTO.getOutAddibleFlag()+", ";
            queryString += "  "+routeStateDTO.getOptions()+", ";
            queryString += "  "+routeStateDTO.getChargeType()+", ";
            queryString += " '"+routeStateDTO.getChargeNumber()+"', ";
            queryString += " '"+routeStateDTO.getZonecode()+"') ";

            log.info(queryString) ;
            count = statement.executeUpdate(queryString);
            if (count < 1) return false ;
        } catch (Exception e) {
            log.error("exception occurred > ", e);
            return false;
        }
        if (count <= 0) return false ;
        return true ;
    }


    public boolean update( QueryStatement statement, RouteStateDTO routeStateDTO  ) {
        String queryString = "";
        int count = 0;
        try {
            if (statement == null) {
                return false;
            }

            int nChannelLimitMode = routeStateDTO.getChannellimitmode() ;
            switch ( nChannelLimitMode ) {
                case 0 :  //  0:제한없음
                    routeStateDTO.setInMaxcall(1000000000) ;
                    routeStateDTO.setOutMaxcall(1000000000) ;
                    routeStateDTO.setTotalmaxcall(1000000000) ;
                    routeStateDTO.setInAlarmcall(0) ;
                    routeStateDTO.setOutAlarmcall(0) ;
                    routeStateDTO.setTotalalarmcall(0) ;
                    break ;
                case 1 : //  1:입/출중계
                    routeStateDTO.setTotalmaxcall(1000000000) ;
                    routeStateDTO.setTotalalarmcall(0) ;
                    break ;
                case 2 : // 2. Total
                    routeStateDTO.setInMaxcall(1000000000) ;
                    routeStateDTO.setOutMaxcall(1000000000) ;
                    routeStateDTO.setInAlarmcall(0) ;
                    routeStateDTO.setOutAlarmcall(0) ;
                    break ;
                case 3 :  // 3. 입/출중계 / Total
                    break ;
            }

            queryString = " UPDATE Table_RouteState SET ";
            queryString += " ENDPOINTCLASS = "+routeStateDTO.getEndpointclass()+", ";
            queryString += " ROUTECODE = '"+routeStateDTO.getRouteCode()+"', ";
            queryString += " ROUTENAME = '"+routeStateDTO.getRouteName()+"', ";
            queryString += " ROUTETYPE = '"+routeStateDTO.getRoutetype()+"', ";
            queryString += " ISLOCAL = "+routeStateDTO.getIsLocal()+", ";
            queryString += " GROUPID = '"+routeStateDTO.getGroupId()+"', ";
            queryString += " GROUPATTACH = "+routeStateDTO.getGroupAttach()+", ";
            queryString += " INCALLEEBLOCK = "+routeStateDTO.getInCalleeBlock()+", ";
            queryString += " INCALLERBLOCK = "+routeStateDTO.getInCallerBlock()+", ";
            queryString += " OUTCALLERBLOCK = "+routeStateDTO.getOutCallerBlock()+", ";
            queryString += " ServiceFlag = "+routeStateDTO.getServiceFlag()+", ";
            queryString += " StateFlag = "+routeStateDTO.getStateFlag()+", ";
            queryString += " CHANNELLIMITMODE = "+routeStateDTO.getChannellimitmode()+", ";
            queryString += " INMAXCALL = "+routeStateDTO.getInMaxcall()+", ";
            queryString += " OUTMAXCALL = "+routeStateDTO.getOutMaxcall()+", ";
            queryString += " TOTALMAXCALL = "+routeStateDTO.getTotalmaxcall()+", ";
            queryString += " INALARMCALL = "+routeStateDTO.getInAlarmcall()+", ";
            queryString += " OUTALARMCALL = "+routeStateDTO.getOutAlarmcall()+", ";
            queryString += " TOTALALARMCALL = "+routeStateDTO.getTotalalarmcall()+", ";
            queryString += " BLOCKCOUNT = "+routeStateDTO.getBlockcount()+", ";
            queryString += " INSTARTPOSITION = "+routeStateDTO.getInstartposition()+", ";
            queryString += " INCUTPREFIX = "+routeStateDTO.getIncutprefix()+", ";
            queryString += " INADDPREFIX = '"+routeStateDTO.getInaddprefix()+"', ";
            queryString += " OUTSTARTPOSITION = "+routeStateDTO.getOutstartposition()+", ";
            queryString += " OUTCUTPREFIX = "+routeStateDTO.getOutcutprefix()+", ";
            queryString += " OUTADDPREFIX = '"+routeStateDTO.getOutaddprefix()+"', ";
            queryString += " INCUTCID = "+routeStateDTO.getInCutcid()+", ";
            queryString += " INADDCID = '"+routeStateDTO.getInAddcid()+"', ";
            queryString += " OUTCUTCID = "+routeStateDTO.getOutCutcid()+", ";
            queryString += " OUTADDCID = '"+routeStateDTO.getOutAddcid()+"', ";
            queryString += " INREPLACE = "+routeStateDTO.getInReplace()+", ";
            queryString += " OUTREPLACE = "+routeStateDTO.getOutReplace()+", ";
            queryString += " MAXDETOURCOUNT = "+routeStateDTO.getMaxdetourcount()+", ";
            queryString += " TIMEOUTFAULT = "+routeStateDTO.getTimeOutFault()+", ";
            queryString += " INADDIBLEFLAG = "+routeStateDTO.getInAddibleFlag()+", ";
            queryString += " OUTADDIBLEFLAG = "+routeStateDTO.getOutAddibleFlag()+", ";
            queryString += " OPTIONS = "+routeStateDTO.getOptions()+", ";
            queryString += " CHARGETYPE = "+routeStateDTO.getChargeType()+", ";
            queryString += " CHARGENUMBER = '"+routeStateDTO.getChargeNumber()+"', ";
            queryString += " ZONECODE = '"+ routeStateDTO.getZonecode()+"' ";
            queryString += " WHERE EndpointID = '" + routeStateDTO.getEndpointid()+ "' " ;

            log.info(queryString) ;
            log.info("statement : "+ statement) ;
            count = statement.executeUpdate(queryString);
            if (count < 1) return false ;
        } catch (Exception e) {
            log.error("exception occurred > ", e);
            return false;
        }
        if (count <= 0) return false ;
        return true ;
    }

    public boolean update( QueryStatement statement, String endpointID, String isLocal  ) {
        String queryString = "";
        int count = 0;
        try {
            if (statement == null) {
                return false;
            }

            queryString  = " UPDATE Table_RouteState SET ";
            queryString += "  ISLOCAL = "+isLocal+" ";
            queryString += " WHERE EndpointID = '" + endpointID + "' " ;
            System.out.println(queryString);
            log.info(queryString) ;
            log.info("statement : "+ statement) ;
            count = statement.executeUpdate(queryString);
            if (count < 1) return false ;
        } catch (Exception e) {
            log.error("exception occurred > ", e);
            return false;
        }
        if (count <= 0) return false ;
        return true ;
    }
    public boolean delete( QueryStatement statement,  String endpointID, int protocol) {
        String queryString = "";
        int count = 0;
        try {
            if (statement == null) {
                return false;
            }
            queryString = " DELETE FROM Table_RouteState WHERE EndpointID = '" + endpointID + "' " ;
            queryString += " AND Protocol = "+ protocol + " ";
            System.out.println(count + " deleted. " + queryString) ;
            count = statement.executeUpdate(queryString);
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
        if (count <= 0) return false ;
        return true ;
    }
    
    

    public boolean delete( QueryStatement statement,  RouteStateDTO routeStateDTO) {
        String queryString = "";
        int count = 0;
        try {
            if (statement == null) {
                return false;
            }
            queryString = " DELETE FROM Table_RouteState WHERE EndpointID = '" + routeStateDTO.getEndpointid()+ "' " ;
            queryString += "' AND Protocol = "+ routeStateDTO.getProtocol()+ " ";
            log.info(queryString) ;
            count = statement.executeUpdate(queryString);
        } catch (Exception e) {
            log.error("exception occurred > ", e);
            return false;
        }
        if (count <= 0) return false ;
        return true ;
    }
}


