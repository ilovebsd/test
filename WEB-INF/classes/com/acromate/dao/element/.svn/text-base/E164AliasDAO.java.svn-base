package  com.acromate.dao.element ;


import com.acromate.db.QueryStatement ;
import java.util.ArrayList ;
import com.acromate.util.Str ;
import java.sql.ResultSet ;
import com.acromate.dto.element.E164AliasDTO ;
import com.acromate.util.Logger;

public class E164AliasDAO {
    private Logger log = Logger.getLogger(this.getClass());

    public E164AliasDAO() {}


    public int getCount(QueryStatement statement, String Alias) {
        ResultSet rs = null ;
        int count = 0 ;
        try {
            String queryString = "SELECT count(*) From TABLE_E164Alias  Where Alias = " + Alias +" ";
            rs = statement.executeQuery(queryString) ;
            if ( rs.next() )  count = rs.getInt(1) ;
        } catch(Exception e) {
            log.error("exception occurred > ", e);
            count = -1 ;
        } finally {
            try {
                if (rs != null) rs.close();
            } catch(Exception e) { log.error("exception occurred > ", e); }
        }
        return count;
    }

    public String getAlias(QueryStatement statement, String e164) {
        String alias = "" ;
        String queryString = "";
        ArrayList list = new ArrayList();
        ResultSet rs = null;
        try {
            queryString = " SELECT Alias";
            queryString += " From TABLE_E164Alias";
            queryString += " WHERE E164='" + e164 + "'";
            System.out.println(queryString);
            rs = statement.executeQuery(queryString);
            while (rs.next())
                alias = Str.CheckNullString(rs.getString("Alias")).trim();
            rs.close();

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            try {
                if (rs != null) rs.close();
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
        return alias;
    }

    public ArrayList getList(QueryStatement statement, E164AliasDTO dto ) {
        String queryString = "" ;
        ArrayList list = new ArrayList() ;
        ResultSet rs = null ;
        E164AliasDTO e164AliasDTO ;

        try {
            queryString = "SELECT " ;
            queryString += "E164, " ;
            queryString += "Alias" ;
            queryString += " From TABLE_E164Alias";
            rs = statement.executeQuery(queryString) ;

            while ( rs.next() )  {
                e164AliasDTO = new E164AliasDTO() ;
                e164AliasDTO.setE164( Str.CheckNullString(rs.getString(0)) ) ;
                e164AliasDTO.setAlias( Str.CheckNullString(rs.getString(1)) ) ;

                list.add(e164AliasDTO) ;
            }
        } catch(Exception e) {
            e.printStackTrace() ;
        } finally {
            try {  if (rs != null) rs.close();  }
            catch(Exception e) { e.printStackTrace(); }
        }
        return list ;
    }

    public E164AliasDTO getDTO(QueryStatement statement, E164AliasDTO dto ) {
        String queryString = "" ;
        ResultSet rs = null ;
        E164AliasDTO e164AliasDTO = null ;

        try {
            queryString = "SELECT " ;
            queryString += "E164, " ;
            queryString += "Alias" ;
            queryString += " From TABLE_E164Alias";
            rs = statement.executeQuery(queryString) ;

            if ( rs.next() )  {
                e164AliasDTO = new E164AliasDTO() ;
                e164AliasDTO.setE164( Str.CheckNullString(rs.getString(0)) ) ;
                e164AliasDTO.setAlias( Str.CheckNullString(rs.getString(1)) ) ;

            }
        } catch(Exception e) {
            e.printStackTrace() ;
        } finally {
            try {  if (rs != null) rs.close();  }
            catch(Exception e) { e.printStackTrace(); }
        }
        return e164AliasDTO ;
    }

    public boolean insert (QueryStatement statement, E164AliasDTO e164AliasDTO ) {
        String queryString = "" ;
        int count = 0 ;

        try {
            queryString = " INSERT INTO TABLE_E164Alias (" ;
            queryString += "E164, " ;
            queryString += "Alias" ;
            queryString += ") VALUES (" ;
            queryString += " '" + e164AliasDTO.getE164() + "' ," ;
            queryString += " '" + e164AliasDTO.getAlias() + "' " ;
            queryString += ")" ;

            count = statement.executeUpdate(queryString) ;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }

    public boolean update (QueryStatement statement, E164AliasDTO e164AliasDTO ) {
        boolean result = true ;
        result = delete(statement,e164AliasDTO.getE164());
        if (result == false) return result;
        result = insert(statement,e164AliasDTO);

        return result ;
    }

    public boolean delete (QueryStatement statement, String e164 ) {
        String queryString = "" ;
        int count = 0 ;

        try {
            queryString = " DELETE FROM TABLE_E164Alias WHERE " ;
            queryString += "E164 = '" + e164 + "'" ;
            count = statement.executeUpdate(queryString) ;
            System.out.println(count + " deleted. " + queryString) ;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }

    public boolean delete (QueryStatement statement, E164AliasDTO e164AliasDTO ) {
        String queryString = "" ;
        int count = 0 ;

        try {
            queryString = " DELETE FROM TABLE_E164Alias WHERE " ;
            queryString += "E164 = '" + e164AliasDTO.getE164() + "' " ;

            count = statement.executeUpdate(queryString) ;
        } catch(Exception e) {
            e.printStackTrace() ;
            return false ;
        }
        return true ;
    }
}


