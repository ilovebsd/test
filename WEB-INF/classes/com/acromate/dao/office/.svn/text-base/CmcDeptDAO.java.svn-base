package com.acromate.dao.office;

import com.acromate.dto.office.CmcDeptDTO;
import com.acromate.db.QueryStatement ;
import java.util.ArrayList;
import com.acromate.util.Str;
import java.sql.ResultSet;
import com.acromate.util.Logger;

public class CmcDeptDAO {
    private Logger log = Logger.getLogger(this.getClass());

    private CmcDeptDTO cmcDeptDTO ;
    QueryStatement statement ;

    public CmcDeptDAO() {}
    public CmcDeptDAO( QueryStatement statement, CmcDeptDTO cmcDeptDTO ) {
        this.statement = statement ;
        this.cmcDeptDTO = cmcDeptDTO ;
    }

    public CmcDeptDTO getDTO(QueryStatement statement , String strDeptID, String strSubOrgID ) {
        CmcDeptDTO cmcDeptDTO = null;
        ResultSet rs = null;

        try {
            String queryString = "SELECT deptID, subOrgID, deptName, SubOrgName,PbxDeptID ";
            queryString += " From Table_CmcDept ";
            queryString += " WHERE deptID = '" + strDeptID + "' ";
            queryString += " AND subOrgID = '" + strSubOrgID + "' " ;


            log.info(queryString) ;
            rs = statement.executeQuery(queryString) ;

            if ( rs.next() )  {
                cmcDeptDTO = new CmcDeptDTO() ;
                cmcDeptDTO.setDeptID(Str.CheckNullString(rs.getString(1)));
                cmcDeptDTO.setSubOrgID(Str.CheckNullString(rs.getString(2)));
                cmcDeptDTO.setDeptName(Str.CheckNullString(rs.getString(3)));
                cmcDeptDTO.setSubOrgName(Str.CheckNullString(rs.getString(4)));
                cmcDeptDTO.setPbxDeptID(rs.getInt(5));
            }
        } catch(Exception e) {
            log.error("exception occurred > ", e);
        } finally {
            try {
                if (rs != null) rs.close();
            } catch(Exception e) { log.error("exception occurred > ", e); }
        }

        return cmcDeptDTO;
    }

    public ArrayList getList(QueryStatement statement ) {
        ArrayList list = new ArrayList();
        CmcDeptDTO cmcDeptDTO = null;
        ResultSet rs = null;

        try {
            String queryString = "SELECT deptID, subOrgID, deptName, SubOrgName,PbxDeptID ";
            queryString += " From Table_CmcDept ";

            log.info(queryString) ;
            rs = statement.executeQuery(queryString) ;

            while ( rs.next() )  {
                cmcDeptDTO = new CmcDeptDTO() ;
                cmcDeptDTO.setDeptID(Str.CheckNullString(rs.getString(1)));
                cmcDeptDTO.setSubOrgID(Str.CheckNullString(rs.getString(2)));
                cmcDeptDTO.setDeptName(Str.CheckNullString(rs.getString(3)));
                cmcDeptDTO.setSubOrgName(Str.CheckNullString(rs.getString(4)));
                cmcDeptDTO.setPbxDeptID(rs.getInt(5));
                list.add(cmcDeptDTO) ;
            }
        } catch(Exception e) {
            log.error("exception occurred > ", e);
        } finally {
            try {
                if (rs != null) rs.close();
            } catch(Exception e) { log.error("exception occurred > ", e); }
        }

        return list;
    }

    public boolean insert ( QueryStatement statement, CmcDeptDTO cmcDeptDTO  ) {
        String queryString = "";
        int count = 0;
        try {
            if (statement == null) {
                return false;
            }

            queryString =  " INSERT INTO Table_CmcDept ";
            queryString += " (deptID, subOrgID, deptName,SubOrgName,PbxDeptID) ";
            queryString += " VALUES (" ;
            queryString += " '"+cmcDeptDTO.getDeptID()+"', ";
            queryString += " '"+cmcDeptDTO.getSubOrgID()+"', ";
            queryString += " '"+cmcDeptDTO.getDeptName()+"', ";
            queryString += " '"+cmcDeptDTO.getSubOrgName()+"', ";
            queryString += "  "+cmcDeptDTO.getPbxDeptID()+" ) ";

            log.info(queryString) ;
            count = statement.executeUpdate(queryString);
        } catch (Exception e) {
            log.error("exception occurred > ", e);
            return false;
        }
        return true ;
    }

    public boolean update( QueryStatement statement, CmcDeptDTO cmcDeptDTO  ) {
        String queryString = "";
        int count = 0;
        try {
            if (statement == null) {
                return false;
            }

            queryString = " UPDATE Table_CmcDept SET ";
            queryString += " deptName = '"+ cmcDeptDTO.getDeptName()+"', ";
            queryString += " SubOrgName = '"+ cmcDeptDTO.getSubOrgName()+"', ";
            queryString += " PbxDeptID = "+ cmcDeptDTO.getPbxDeptID()+" ";
            queryString += " WHERE deptID = '" + cmcDeptDTO.getDeptID() + "' ";
            queryString += " AND subOrgID = '" + cmcDeptDTO.getSubOrgID() + "' " ;

            count = statement.executeUpdate(queryString);
            log.info(queryString) ;
        } catch (Exception e) {
            log.error("exception occurred > ", e);
            return false;
        }
        return true ;
    }


    public boolean deleteAll( QueryStatement statement ) {
        String queryString = "";
        int count = 0;
        try {
            if (statement == null) {
                return false;
            }
            queryString = " DELETE FROM Table_CmcDept " ;

            count = statement.executeUpdate(queryString);
            log.info(queryString) ;
        } catch (Exception e) {
            log.error("exception occurred > ", e);
            return false;
        }
        return true ;
    }

    public boolean deleteAllSubOrg( QueryStatement statement, String strSubOrgID ) {
        String queryString = "";
        int count = 0;
        try {
            if (statement == null) {
                return false;
            }
            queryString = " DELETE FROM Table_CmcDept WHERE SubOrgID = '" + strSubOrgID + "' ";
            count = statement.executeUpdate(queryString);
            log.info(queryString) ;
        } catch (Exception e) {
            log.error("exception occurred > ", e);
            return false;
        }
        return true ;
    }


}
