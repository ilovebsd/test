/*
 * NFreeSystem.java
 *
 * Created on 2007년 8월 9일 (목), 오후 9:41
 *
 * To change this template, choose Tools | Template Manager
 * and open the template in the editor.
 */

package com.acromate.system;

import com.acromate.data.DataIO;
import com.acromate.util.Logger;

/**
 *
 * @author pljoin1024
 */
public class NFreeSystem extends CustomSystem {
    private Logger log = Logger.getLogger(this.getClass());

    /** Creates a new instance of NFreeSystem */
    private int errorcode ;
    public NFreeSystem() {

    }

    /**
     *
     * @return
     */
    public DataIO getActiveSystem() {
        if(procStatus > 0)
              return this;
        else return null;
    }

    public String getClassID() {
        return processId.toString();
    }


    /**
     *
     * @param field
     * @param value
     * @return
     */
    protected int setFieldData(String field, String value) {
         StringBuilder temp = new StringBuilder(field);
         if (value.equals("")) return 0;
        if(compareFieldID(temp, "groupId") == true) {
            return setString(groupId, value);
        }
        if(compareFieldID(temp, "groupName") == true) {
            return setString(groupName, value);
        }
        if(compareFieldID(temp, "hwClusterId") == true) {
            return setString(hwClusterId, value);
        }
        if(compareFieldID(temp, "hwId") == true) {
            return setString(hwId, value);
        }
        if(compareFieldID(temp, "hwName") == true) {
            return setString(hwName, value);
        }
        if(compareFieldID(temp, "clusterId") == true) {
            return setString(clusterId, value);
        }
        if(compareFieldID(temp, "clusterName") == true) {
            return setString(clusterName, value);
        }
        if(compareFieldID(temp, "processId") == true) {
            return setString(processId, value);
        }
        if(compareFieldID(temp, "status") == true) {
            if(!value.equals("")) procStatus = Integer.valueOf(value);
            return 0;
        }
        if(compareFieldID(temp, "dbConnString") == true) {
            return setString(dbConnString, value);
        }
        if(compareFieldID(temp, "dbUserName") == true) {
            return setString(dbUserName, value);
        }
        if(compareFieldID(temp, "dbPassword") == true) {
            return setString(dbPassword, value);
        }
        if(compareFieldID(temp, "dbDriverClass") == true) {
            return setString(dbDriverClass, value);
        }
        if(compareFieldID(temp, "defaultSystem") == true) {
            return setString(defaultSystem, value);
        }
        log.error("SswSystem - Not founded field :" + field);
        return(-1);
    }

    /**
     *
     * @param field
     * @param index
     * @param value
     * @param length
     * @return
     */
    protected int getFieldData(String field, Index idx, StringBuilder value) {
        boolean resultVal = false;
        StringBuilder fldAlias;
        if(field != null && !field.equals("")) resultVal = true;
        if(field == null) {
            fldAlias = new StringBuilder(); fldAlias.append("");
        } else {
           fldAlias  = new StringBuilder(); fldAlias.append(field);
        }

        if(compareFieldID(fldAlias, "groupId", idx, value) == true) {
            errorcode = getString(groupId.toString(), value, !resultVal);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "hwClusterId", idx, value) == true) {
            errorcode = getString(hwClusterId.toString(), value, !resultVal);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "hwId", idx, value) == true) {
            errorcode = getString(hwId.toString(), value, !resultVal);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "clusterId", idx, value) == true) {
            errorcode = getString(clusterId.toString(), value, !resultVal);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "processId", idx, value) == true) {
            errorcode = getString(processId.toString(), value, !resultVal);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "status", idx, value) == true) {
            errorcode = getInteger(procStatus, value);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "groupName", idx, value) == true) {
            errorcode = getString(groupName.toString(), value, !resultVal);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "hwName", idx, value) == true) {
            errorcode = getString(hwName.toString(), value, !resultVal);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "clusterName", idx, value) == true) {
            errorcode = getString(clusterName.toString(), value, !resultVal);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "dbConnString", idx, value) == true) {
            errorcode = getString(dbConnString.toString(), value, !resultVal);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "dbUserName", idx, value) == true) {
            errorcode = getString(dbUserName.toString(), value, !resultVal);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "dbPassword", idx, value) == true) {
            errorcode = getString(dbPassword.toString(), value, !resultVal);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "dbDriverClass", idx, value) == true) {
            errorcode = getString(dbDriverClass.toString(), value, !resultVal);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "defaultSystem", idx, value) == true) {
            errorcode = getString(defaultSystem.toString(), value, !resultVal);
            if(resultVal || errorcode < 0) return errorcode;
        }
        return 0;
    }
    /**
     *
     * @return
     */
    public boolean initSystem() {
        return true;
    }

    /**
     *
     * @return
     */
    public boolean startSystem() {
        return true;
    }

    /**
     *
     */
    public void finalSystem() {

    }
}
