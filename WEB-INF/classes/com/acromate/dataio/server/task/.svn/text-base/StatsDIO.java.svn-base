package com.acromate.dataio.server.task ;

import org.apache.log4j.Logger;
import com.acromate.data.DataIO;
import com.acromate.util.Str;
import com.acromate.dataio.server.task.call.CallDIO;
import com.acromate.dataio.server.task.cdr.CdrDIO;

public class StatsDIO extends DataIO {
    private Logger log = Logger.getLogger(this.getClass());

    private int    errorcode;
    private CallDIO call = new CallDIO();
    private CdrDIO cdr = new CdrDIO();
    private TaskListDIO task = new TaskListDIO();

    public CallDIO    getCallDIO() { return call ; }
    public void   setCallDIO( CallDIO call ) { this.call = call ; }

    public CdrDIO    getCdrDIO() { return cdr ; }
    public void   setCdrDIO( CdrDIO cdr ) { this.cdr = cdr ; }

    public TaskListDIO    getTaskDIO() { return task ; }
    public void   setTaskDIO( TaskListDIO task ) { this.task = task ; }


    protected int setFieldData(String field, String value) {
        StringBuilder temp = new StringBuilder(field.toLowerCase());
        if(compareFieldID(temp, "call".toLowerCase()) == true) {
            return call.setParam(temp.toString(), value);
        }
        if(compareFieldID(temp, "cdr".toLowerCase()) == true) {
            return cdr.setParam(temp.toString(), value);
        }
        if(compareFieldID(temp, "task".toLowerCase()) == true) {
            return task.setParam(temp.toString(), value);
        }
        log.error("StatsDIO - Not founded field :" + field);
        return 0;
    }

    protected int getFieldData(String field, Index idx, StringBuilder value) {
        boolean resultVal = false;
        StringBuilder fldAlias;
        if(field != null && !field.equals("")) resultVal = true;
        if(field == null) {
            fldAlias = new StringBuilder(); fldAlias.append("");
        } else {
           fldAlias  = new StringBuilder(); fldAlias.append(field);
        }
        if(compareFieldID(fldAlias, "call", idx, value) == true) {
            errorcode = call.getParam(fldAlias.toString(), value);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "cdr", idx, value) == true) {
            errorcode = cdr.getParam(fldAlias.toString(), value);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "task", idx, value) == true) {
            errorcode = task.getParam(fldAlias.toString(), value);
            if(resultVal || errorcode < 0) return errorcode;
        }
        return(0);
    }
}
