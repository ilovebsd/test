package com.acromate.dataio.server.task.call ;

import com.acromate.util.Logger;
import com.acromate.data.DataIO;
import com.acromate.data.code.AppCode;
import com.acromate.dataio.server.task.TaskDIO;
import com.acromate.util.Str;

public class SummaryDIO extends TaskDIO {
    private Logger log = Logger.getLogger(this.getClass());

    private int    errorcode;
    private HandlerDIO todayCall = new HandlerDIO();
    private HandlerDIO callType = new HandlerDIO();
    private HandlerDIO serviceType = new HandlerDIO();
    private HandlerDIO route = new HandlerDIO();
    private HandlerDIO ippbx = new HandlerDIO();
    private HandlerDIO serviceCode = new HandlerDIO();
    private HandlerDIO failCode = new HandlerDIO();
    private HandlerDIO longCall = new HandlerDIO();
    private HandlerDIO calleePrefix = new HandlerDIO();
    private HandlerDIO ippbxType = new HandlerDIO();

    public SummaryDIO(){
    	super.setParam("enable", "true");
    }

    public HandlerDIO    getTodayCallDIO() { return todayCall ; }
    public void   setTodayCallDIO( HandlerDIO todayCall ) { this.todayCall = todayCall ; }

    public HandlerDIO    getCallTypeDIO() { return callType ; }
    public void   setCallTypeDIO( HandlerDIO callType ) { this.callType = callType ; }

    public HandlerDIO    getServiceTypeDIO() { return serviceType ; }
    public void   setServiceTypeDIO( HandlerDIO serviceType ) { this.serviceType = serviceType ; }

    public HandlerDIO    getRouteDIO() { return route ; }
    public void   setRouteDIO( HandlerDIO route ) { this.route = route ; }

    public HandlerDIO    getIppbxDIO() { return ippbx ; }
    public void   setIppbxDIO( HandlerDIO ippbx ) { this.ippbx = ippbx ; }

    public HandlerDIO    getServiceCodeDIO() { return serviceCode ; }
    public void   setServiceCodeDIO( HandlerDIO serviceCode ) { this.serviceCode = serviceCode ; }

    public HandlerDIO    getFailCodeDIO() { return failCode ; }
    public void   setFailCodeDIO( HandlerDIO failCode ) { this.failCode = failCode ; }

    public HandlerDIO    getLongCallDIO() { return longCall ; }
    public void   setLongCallDIO( HandlerDIO longCall ) { this.longCall = longCall ; }

    public HandlerDIO    getCalleePrefixDIO() { return calleePrefix ; }
    public void   setCalleePrefixDIO( HandlerDIO calleePrefix ) { this.calleePrefix = calleePrefix ; }

    public HandlerDIO    getIppbxTypeDIO() { return ippbxType ; }
    public void   setIppbxTypeDIO( HandlerDIO ippbxType ) { this.ippbxType = ippbxType ; }

    protected int setFieldData(String field, String value) {
        StringBuilder temp = new StringBuilder(field.toLowerCase());

        if(compareFieldID(temp, "todayCall".toLowerCase()) == true) {
            return todayCall.setParam(temp.toString(), value);
        }
        if(compareFieldID(temp, "callType".toLowerCase()) == true) {
            return callType.setParam(temp.toString(), value);
        }
        if(compareFieldID(temp, "serviceType".toLowerCase()) == true) {
            return serviceType.setParam(temp.toString(), value);
        }
        if(compareFieldID(temp, "route".toLowerCase()) == true) {
            return route.setParam(temp.toString(), value);
        }
        if(compareFieldID(temp, "ippbx".toLowerCase()) == true) {
            return ippbx.setParam(temp.toString(), value);
        }
        if(compareFieldID(temp, "serviceCode".toLowerCase()) == true) {
            return serviceCode.setParam(temp.toString(), value);
        }
        if(compareFieldID(temp, "failCode".toLowerCase()) == true) {
            return failCode.setParam(temp.toString(), value);
        }
        if(compareFieldID(temp, "longCall".toLowerCase()) == true) {
            return longCall.setParam(temp.toString(), value);
        }
        if(compareFieldID(temp, "calleePrefix".toLowerCase()) == true) {
            return calleePrefix.setParam(temp.toString(), value);
        }
        if(compareFieldID(temp, "ippbxType".toLowerCase()) == true) {
            return ippbxType.setParam(temp.toString(), value);
        }
        int result = super.setFieldData(field, value);
        if (result != AppCode.ERR_NOERROR) log.error("SummaryDIO - Not founded field :" + field);
        return result;
    }

    protected int getFieldData(String field, Index idx, StringBuilder value) {
        boolean resultVal = false;
        StringBuilder fldAlias;
        if(field != null && !field.equals("")) resultVal = true;
        if(field == null) {
            fldAlias = new StringBuilder(); fldAlias.append("");
        } else {
           fldAlias  = new StringBuilder(); fldAlias.append(field);
        }
        if(compareFieldID(fldAlias, "todayCall", idx, value) == true) {
            errorcode = todayCall.getParam(fldAlias.toString(), value);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "callType", idx, value) == true) {
            errorcode = callType.getParam(fldAlias.toString(), value);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "serviceType", idx, value) == true) {
            errorcode = serviceType.getParam(fldAlias.toString(), value);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "route", idx, value) == true) {
            errorcode = route.getParam(fldAlias.toString(), value);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "ippbx", idx, value) == true) {
            errorcode = ippbx.getParam(fldAlias.toString(), value);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "serviceCode", idx, value) == true) {
            errorcode = serviceCode.getParam(fldAlias.toString(), value);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "failCode", idx, value) == true) {
            errorcode = failCode.getParam(fldAlias.toString(), value);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "longCall", idx, value) == true) {
            errorcode = longCall.getParam(fldAlias.toString(), value);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "calleePrefix", idx, value) == true) {
            errorcode = calleePrefix.getParam(fldAlias.toString(), value);
            if(resultVal || errorcode < 0) return errorcode;
        }
        if(compareFieldID(fldAlias, "ippbxType", idx, value) == true) {
            errorcode = ippbxType.getParam(fldAlias.toString(), value);
            if(resultVal || errorcode < 0) return errorcode;
        }
        return super.getFieldData(field,idx,value);
    }
}

