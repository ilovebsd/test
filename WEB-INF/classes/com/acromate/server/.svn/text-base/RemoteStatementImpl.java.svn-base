package com.acromate.server;

import java.rmi.*;
import java.rmi.server.*;
import java.sql.*;


public class RemoteStatementImpl extends UnicastRemoteObject
	implements IRemoteStatement
{

	private static final long serialVersionUID = 1L;
	private Statement sqlStatment;

	/*******************************************************************
	 *
	 * @param sqlStmt
	 * @throws RemoteException
	 */
	public RemoteStatementImpl(Statement sqlStmt) throws RemoteException
	{
		super();
		sqlStatment = sqlStmt;
	}

	/*******************************************************************
	 *
	 */
	public IRemoteResultSet executeQuery(String Query) throws RemoteException,SQLException
	{
		ResultSet rs = sqlStatment.executeQuery(Query);
		RemoteResultSetImpl remoteRs = new RemoteResultSetImpl(rs);
		return (IRemoteResultSet)remoteRs;
	}

	/*******************************************************************
	 *
	 */
        public boolean execute(String Query) throws RemoteException,SQLException
        {
                return sqlStatment.execute(Query);
        }

	public int executeUpdate(String Query) throws RemoteException,SQLException
	{
		return sqlStatment.executeUpdate(Query);
	}

	/*******************************************************************
	 *
	 */
	public void close() throws RemoteException,SQLException
	{
		sqlStatment.close();
	}
}
